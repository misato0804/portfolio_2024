import React, { Dispatch, SetStateAction, useEffect, useRef } from 'react'
import gsap from 'gsap';

export const PreLoader = ({ setIsLoading} : { setIsLoading: Dispatch<SetStateAction<boolean>> }) => {
  const svgRef = useRef<SVGSVGElement>(null)

  useEffect(() => {
    const tl = gsap.timeline();
    if (svgRef.current) {
      const paths = Array.from(svgRef.current.querySelectorAll('path'));
      const reversedPaths = paths.reverse();

      reversedPaths.forEach((path, index) => {
        const offSetLength = path.getTotalLength();

        gsap.set(path, {
          strokeDasharray: offSetLength,
          strokeDashoffset: offSetLength,
          stroke: 'black',
          fill: 'none',
        });

        tl.to(
          path,
          {
            strokeDashoffset: 0,
            duration: 1,
            ease: 'power2.inOut',
          },
          index * 0.2 
        );
      });

      tl.to(
        svgRef.current,
        {
          opacity: 0,
          duration: 1,
          ease: 'power2.out',
          onComplete: () => {
            window.addEventListener("load", () => {
              setIsLoading(false);
            });
          }
        },
        '+=1' 
      );
    }
    const timeout = setTimeout(() => {
      setIsLoading(false);
    }, 4000);

    return () => clearTimeout(timeout);
  }, [])

  return (
    <div className="w-screen h-screen flex justify-center items-center">
      <svg ref={svgRef} width="484" height="74" viewBox="0 0 484 74" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M466.699 24.8882L466.803 25.25H467.179H482.179H482.753L482.675 24.6816C482.189 21.1657 481.089 17.9438 479.373 15.021C477.659 12.0797 475.447 9.5435 472.739 7.41426C470.054 5.28539 466.98 3.64534 463.52 2.49198C460.055 1.31398 456.319 0.727264 452.316 0.727264C447.642 0.727264 443.294 1.54476 439.274 3.18478C435.255 4.82488 431.731 7.2168 428.705 10.3577C425.676 13.5031 423.323 17.3363 421.642 21.8482L421.642 21.8495C419.982 26.3466 419.156 31.4523 419.156 37.1591C419.156 44.5847 420.543 51.0299 423.337 56.4781L423.338 56.4804C426.152 61.9007 430.08 66.0971 435.119 69.0562L435.121 69.057C440.162 71.9939 446.001 73.4545 452.622 73.4545C458.555 73.4545 463.84 72.2584 468.467 69.8527L468.468 69.8518C473.095 67.4226 476.733 63.9713 479.371 59.5043L479.372 59.5033C482.016 55.0034 483.327 49.6394 483.327 43.4318V34.6364V34.1364H482.827H453.611H453.111V34.6364V45.75V46.25H453.611H468.089C467.967 48.7542 467.357 50.931 466.27 52.7935L466.268 52.7969C465.07 54.8882 463.327 56.5151 461.023 57.6784C458.744 58.8172 455.973 59.3977 452.691 59.3977C449.093 59.3977 445.998 58.5329 443.386 56.8212C440.774 55.0866 438.741 52.566 437.297 49.233C435.854 45.9028 435.122 41.8381 435.122 37.0227C435.122 32.2078 435.865 28.168 437.329 24.8855L437.33 24.8843C438.797 21.572 440.83 19.073 443.42 17.3606C446.035 15.6472 449.073 14.7841 452.554 14.7841C454.422 14.7841 456.111 15.0176 457.625 15.4783L457.626 15.4789C459.167 15.941 460.523 16.6095 461.7 17.4813L461.7 17.4814L461.708 17.4874C462.907 18.3378 463.922 19.3842 464.752 20.6296L464.754 20.633C465.585 21.8571 466.234 23.2737 466.699 24.8882Z" fill="white" stroke="black" />
        <path d="M399.588 2.18182V1.68182H399.088H384.395H383.895V2.18182V45.3729L354.057 1.89889L353.908 1.68182H353.645H340.69H340.19V2.18182V72V72.5H340.69H355.451H355.951V72V28.9197L385.926 72.2843L386.076 72.5H386.338H399.088H399.588V72V2.18182Z" fill="white" stroke="black" />
        <path d="M319.445 2.18182V1.68182H318.945H304.184H303.684V2.18182V72V72.5H304.184H318.945H319.445V72V2.18182Z" fill="white" stroke="black" />
        <path d="M224.24 72V72.5H224.74H249.49C256.647 72.5 262.824 71.0891 268.003 68.2451C273.204 65.4019 277.194 61.3185 279.967 56.0055C282.762 50.6917 284.149 44.3581 284.149 37.0227C284.149 29.7103 282.762 23.3993 279.967 18.1081C277.195 12.8184 273.227 8.75758 268.072 5.93682C262.916 3.09297 256.784 1.68182 249.695 1.68182H224.74H224.24V2.18182V72ZM266.184 49.563L266.183 49.5644C264.727 52.7427 262.552 55.0769 259.657 56.5904C256.769 58.0894 253.183 58.8523 248.876 58.8523H240.001V15.3296H248.911C253.217 15.3296 256.804 16.0924 259.692 17.5915C262.562 19.0818 264.726 21.404 266.183 24.5833L266.184 24.5859C267.666 27.7705 268.422 31.9075 268.422 37.0227C268.422 42.184 267.666 46.3554 266.184 49.563Z" fill="white" stroke="black" />
        <path d="M155.362 72.5H155.725L155.837 72.1547L160.904 56.5796H185.386L190.443 72.1544L190.555 72.5H190.918H206.737H207.438L207.209 71.8371L183.141 2.01887L183.025 1.68182H182.668H163.646H163.289L163.173 2.01866L139.071 71.8368L138.842 72.5H139.543H155.362ZM181.32 44.0568H164.978L173.157 18.9149L181.32 44.0568Z" fill="white" stroke="black" />
        <path d="M110.92 69.1963L110.921 69.196C115.962 66.3284 119.936 62.1778 122.841 56.7598C125.775 51.3297 127.23 44.7665 127.23 37.0909C127.23 29.4153 125.775 22.8521 122.841 17.4221C119.936 12.0041 115.962 7.86471 110.92 5.01974C105.907 2.15524 100.275 0.727264 94.0372 0.727264C87.7542 0.727264 82.0993 2.15501 77.0853 5.02001C72.066 7.86527 68.1037 12.005 65.1988 17.4228C62.2875 22.8527 60.844 29.4155 60.844 37.0909C60.844 44.7438 62.2876 51.2952 65.1988 56.7249C68.1037 62.1428 72.0658 66.2935 77.0846 69.1614C82.0988 72.0267 87.7539 73.4545 94.0372 73.4545C100.275 73.4545 105.907 72.038 110.92 69.1963ZM109.089 24.811L109.09 24.8136C110.532 28.1195 111.264 32.2061 111.264 37.0909C111.264 41.9757 110.532 46.0623 109.09 49.3682L109.089 49.3708C107.667 52.6818 105.668 55.1669 103.103 56.8551C100.535 58.545 97.5199 59.3977 94.0372 59.3977C90.5545 59.3977 87.539 58.545 84.9712 56.8551C82.4057 55.1667 80.3955 52.6811 78.9506 49.3696C77.5306 46.0631 76.8099 41.976 76.8099 37.0909C76.8099 32.2058 77.5306 28.1186 78.9507 24.8121C80.3955 21.5007 82.4058 19.0151 84.9712 17.3268C87.539 15.6368 90.5545 14.7841 94.0372 14.7841C97.5199 14.7841 100.535 15.6368 103.103 17.3268C105.668 19.0149 107.667 21.5 109.089 24.811Z" fill="white" stroke="black" />
        <path d="M0.721313 72V72.5H1.22131H45.9145H46.4145V72V59.8296V59.3296H45.9145H16.4827V2.18182V1.68182H15.9827H1.22131H0.721313V2.18182V72Z" fill="white" stroke="black" />
      </svg>
    </div>
  )
}
